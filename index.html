<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Riesgo y Posición de Trading</title>
    <style>
        /* --- ESTILOS ORIGINALES --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 1.1em; }
        .input-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .input-group { background: #f8f9fa; padding: 20px; border-radius: 15px; border-left: 4px solid #667eea; transition: all 0.3s ease; }
        .input-group:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 0.9em; text-transform: uppercase; letter-spacing: 0.5px; }
        .input-group input { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.1em; transition: all 0.3s ease; background: white; }
        .input-group input:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .trade-type-indicator { text-align: center; margin: 20px 0; }
        .trade-badge { display: inline-block; padding: 12px 24px; border-radius: 25px; font-weight: bold; font-size: 1.1em; letter-spacing: 1px; transition: all 0.3s ease; text-transform: uppercase; }
        .trade-badge.long { background: linear-gradient(135deg, #4caf50, #45a049); color: white; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3); }
        .trade-badge.short { background: linear-gradient(135deg, #f44336, #d32f2f); color: white; box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3); }
        .trade-badge:hover { transform: translateY(-2px); }
        .main-result { margin: 20px 0; text-align: center; }
        .shares-display { background: linear-gradient(135deg, #4CAF50, #45a049); border: 4px solid #ffffff; border-radius: 20px; padding: 20px; box-shadow: 0 15px 40px rgba(76, 175, 80, 0.4); transition: all 0.3s ease; position: relative; overflow: hidden; }
        .shares-display.short-mode { background: linear-gradient(135deg, #f44336, #d32f2f); box-shadow: 0 15px 40px rgba(244, 67, 54, 0.4); }
        .shares-label { color: rgba(255, 255, 255, 0.9); font-size: 1em; font-weight: bold; letter-spacing: 2px; margin-bottom: 8px; }
        .shares-value { color: white; font-size: 3.2em; font-weight: 900; }
        .shares-unit { color: rgba(255, 255, 255, 0.8); font-size: 0.9em; font-weight: 600; }
        .results-section { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px; }
        .result-card { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; text-align: center; transition: all 0.3s ease; }
        .result-card:hover { transform: scale(1.05); }
        .warning { background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center; font-weight: 500; display: none; }
        .info-panel { background: #e3f2fd; border: 1px solid #2196f3; border-radius: 10px; padding: 20px; margin-top: 20px; }
        @media (max-width: 768px) { .input-section { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>📊 CALCULADORA DE RIESGO</h1>
        <p class="subtitle">Gestiona tu riesgo de trading de forma profesional</p>

        <div class="input-section">
            <div class="input-group"><label>💰 Capital Total ($)</label><input type="number" id="capital" value="2000" min="0" step="0.01"></div>
            <div class="input-group"><label>⚠️ Riesgo por Operación (%)</label><input type="number" id="riesgo" value="1" min="0.1" max="100" step="0.1"></div>
            <div class="input-group"><label>📈 Precio de Entrada ($)</label><input type="number" id="entrada" value="4" min="0" step="0.01"></div>
            <div class="input-group"><label>🛑 Stop Loss ($)</label><input type="number" id="stopLoss" value="3.50" min="0" step="0.01"></div>
        </div>

        <div class="trade-type-indicator"><div class="trade-badge long">📈 OPERACIÓN LONG</div></div>

        <div class="main-result">
            <div class="shares-display">
                <div class="shares-label">🎯 CANTIDAD A COMPRAR</div>
                <div class="shares-value" id="sharesMain">40</div>
                <div class="shares-unit">ACCIONES</div>
            </div>
        </div>

        <div class="results-section">
            <div class="result-card"><h3>Riesgo en Dinero</h3><div class="value" id="riesgoDinero">$20</div><div class="unit">Máxima pérdida</div></div>
            <div class="result-card"><h3>Riesgo por Acción</h3><div class="value" id="riesgoPorAccion">$0.50</div><div class="unit">Pérdida por share</div></div>
            <div class="result-card"><h3>Inversión Total</h3><div class="value" id="inversionTotal">$160</div><div class="unit">Capital utilizado</div></div>
        </div>

        <div class="warning" id="warning">⚠️ Advertencia: Verifica los precios de entrada y stop loss.</div>
    </div>

    <script>
        function calcular() {
            const capital = parseFloat(document.getElementById('capital').value) || 0;
            const riesgoPorcentaje = parseFloat(document.getElementById('riesgo').value) || 0;
            const precioEntrada = parseFloat(document.getElementById('entrada').value) || 0;
            const stopLoss = parseFloat(document.getElementById('stopLoss').value) || 0;

            const riesgoDinero = capital * (riesgoPorcentaje / 100);
            let riesgoPorAccion;
            const tradeBadge = document.querySelector('.trade-badge');

            if (precioEntrada > stopLoss) {
                riesgoPorAccion = precioEntrada - stopLoss;
                tradeBadge.textContent = '📈 OPERACIÓN LONG';
                tradeBadge.className = 'trade-badge long';
            } else if (precioEntrada < stopLoss) {
                riesgoPorAccion = stopLoss - precioEntrada;
                tradeBadge.textContent = '📉 OPERACIÓN SHORT';
                tradeBadge.className = 'trade-badge short';
            } else {
                riesgoPorAccion = 0;
                tradeBadge.textContent = '⚠️ PRECIOS IGUALES';
                tradeBadge.className = 'trade-badge';
            }

            const warning = document.getElementById('warning');
            warning.style.display = 'none';

            let cantidadAcciones = riesgoPorAccion > 0 ? Math.floor(riesgoDinero / riesgoPorAccion) : 0;

            // Limitar para no superar capital disponible
            const maxAccionesPorCapital = Math.floor(capital / precioEntrada);
            if (cantidadAcciones > maxAccionesPorCapital) {
                cantidadAcciones = maxAccionesPorCapital;
                warning.style.display = 'block';
                warning.textContent = '⚠️ Cantidad ajustada para no superar el capital disponible.';
            }

            const inversionTotal = cantidadAcciones * precioEntrada;

            updateValue('riesgoDinero', `$${riesgoDinero.toFixed(2)}`);
            updateValue('riesgoPorAccion', `$${riesgoPorAccion.toFixed(2)}`);
            updateValue('inversionTotal', `$${inversionTotal.toFixed(2)}`);
            updateMainShares(cantidadAcciones, precioEntrada < stopLoss ? 'SHORT' : 'LONG');
        }

        function updateMainShares(cantidad, tipo) {
            const sharesMain = document.getElementById('sharesMain');
            const sharesDisplay = document.querySelector('.shares-display');
            sharesDisplay.style.transform = 'scale(1.1)';
            setTimeout(() => {
                sharesMain.textContent = cantidad.toLocaleString();
                sharesDisplay.classList.toggle('short-mode', tipo === 'SHORT');
                sharesDisplay.style.transform = 'scale(1)';
            }, 150);
        }

        function updateValue(id, val) {
            const el = document.getElementById(id);
            el.style.transform = 'scale(1.1)';
            setTimeout(() => {
                el.textContent = val;
                el.style.transform = 'scale(1)';
            }, 100);
        }

        document.addEventListener('DOMContentLoaded', () => {
            ['capital', 'riesgo', 'entrada', 'stopLoss'].forEach(id => {
                document.getElementById(id).addEventListener('input', calcular);
            });
            calcular();
        });
    </script>
</body>
</html>
